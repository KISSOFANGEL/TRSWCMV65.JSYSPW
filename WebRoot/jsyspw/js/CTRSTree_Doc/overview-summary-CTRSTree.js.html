<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
 Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>
function asd() {
	
		parent.document.title="CTRSTree.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>CTRSTree.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		此文件定义了CTRSTree对象，完成树形结构的构造<BR>
  Copyright: 		www.trs.com.cn<BR>
  Company: 		TRS Info. Ltd.<BR>
  Author:			CH<BR>
  Created:		2004-09-24 08:38<BR>
  Vesion:			1.0<BR>
  Last EditTime:	2004-11-24/2004-11-24<BR>
	Update Logs:<BR>
		CH@2004-09-24 Created File<BR>
	Note:<BR>
		<BR>
	Depends:<BR>
		CTRSTree_res_default.js<BR>
	Examples:<BR>
		../test/CTRSTree_test.html<BR>
 <BR/><BR/><B>Version: </B>1.o<BR/><BR/><B>Author:</B> CH cao.hui@trs.com.cn
 <BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="CDebugTimer.html">CDebugTimer</a></b></td>
    <td>&nbsp;</td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="TRSTreeItem.html">TRSTreeItem</a></b></td>
    <td>&nbsp;</td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="CTRSTree.html">CTRSTree</a></b></td>
    <td>CTRSTree类
 </td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

	<a name="method_summary"><!-- --></a>
	<table border="1" cellpadding="3" cellspacing="0" width="100%">
		<tr bgcolor="#CCCCFF" class="TableHeadingColor">
			<td colspan=2>
				<font size="+2">
					<b>Method Summary</b>
				</font>
			</td>
		</tr>
	
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;void</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#TRSTreeItem_loadChildren">TRSTreeItem_loadChildren</a></b>(_oTRSTree, _sParentId, _oCurrItem)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 根据指定的父节点ID动态载入子节点的列表（抽象方法）
（动态载入子节点的树形结构需要实现此方法）
		      </td>
		   </tr>
		
	
	</table>
    <p>

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">/** 
 * <span class="attrib">@fileoverview</span> 
 * 此文件定义了CTRSTree对象，完成树形结构的构造&lt;BR&gt;
 *  Copyright: 		www.trs.com.cn&lt;BR&gt;
 *  Company: 		TRS Info. Ltd.&lt;BR&gt;
 *  Author:			CH&lt;BR&gt;
 *  Created:		2004-09-24 08:38&lt;BR&gt;
 *  Vesion:			1.0&lt;BR&gt;
 *  Last EditTime:	2004-11-24/2004-11-24&lt;BR&gt;
 *	Update Logs:&lt;BR&gt;
 *		CH<span class="attrib">@2004</span>-09-24 Created File&lt;BR&gt;
 *	Note:&lt;BR&gt;
 *		&lt;BR&gt;
 *	Depends:&lt;BR&gt;
 *		CTRSTree_res_default.js&lt;BR&gt;
 *	Examples:&lt;BR&gt;
 *		../test/CTRSTree_test.html&lt;BR&gt;
 * <span class="attrib">@author</span> CH cao.hui<span class="attrib">@trs</span>.com.cn
 * <span class="attrib">@version</span> 1.o
 */</span>
<span class="comment">/**
 * CTRSTree构造函数
 * <span class="attrib">@class</span> CTRSTree类
 * <span class="attrib">@constructor</span>
 * <span class="attrib">@param</span> {String} _sInitCheckValues 初始化选择型树形结构的ID序列(可以不传入)
 * <span class="attrib">@param</span> {Object} _oTRSTreeRes TRSTree资源对象，默认为TREE_ICON_RES
 * <span class="attrib">@param</span> {String} _sTarget 树中结点点击操作的Target
 * <span class="attrib">@param</span> {String} _sDisabledIds 禁用的ID序列
 * <span class="attrib">@return</span> CWCMAction的一个实例
 */</span>
<span class="reserved">function</span> CTRSTree(_sInitCheckValues, _oTRSTreeRes, _sTarget, _sDisabledIds){
<span class="comment">//Define CTRSTree's Properties</span>
	<span class="comment">/** <span class="attrib">@private</span> */</span>
	<span class="reserved">this</span>.arRootTRSItems	= [];
	<span class="comment">/** <span class="attrib">@private</span> */</span>
	<span class="reserved">this</span>.hTRSItems		= {};	
	<span class="comment">/** <span class="attrib">@private</span> */</span>
	<span class="reserved">this</span>.oTRSTreeRes	= _oTRSTreeRes || TREE_ICON_RES;
	<span class="comment">/** <span class="attrib">@private</span> */</span>
	<span class="reserved">this</span>.sTarget		= _sTarget || <span class="reserved">this</span>.oTRSTreeRes[<span class="literal">'target'</span>];
	<span class="reserved">this</span>.nType			= TRSTREE_TYPE_NORMAL;
	<span class="comment">/** <span class="attrib">@private</span> */</span>
	<span class="reserved">this</span>.arDisabledId   = new Array();
	<span class="reserved">if</span>(_sDisabledIds) <span class="reserved">this</span>.arDisabledId = _sDisabledIds.split(<span class="literal">","</span>);

	<span class="comment">/** <span class="attrib">@private</span> */</span>
	<span class="reserved">this</span>.oSelectedItem	= null;

	<span class="comment">/** <span class="attrib">@private</span> */</span>
	<span class="reserved">this</span>.sId			= m_arTRSTrees.length;
	m_arTRSTrees[<span class="reserved">this</span>.sId] = <span class="reserved">this</span>;	

	<span class="reserved">this</span>.setInitCheckValues = CTRSTree_setInitCheckValues;	
	<span class="reserved">this</span>.setInitCheckValues(_sInitCheckValues);
<span class="comment">
//Define CTRSTree's Methods</span>
	<span class="comment">/** <span class="attrib">@private</span> */</span>
	<span class="reserved">this</span>.onMouseOver	= <span class="reserved">function</span>(_sItemId){
		<span class="reserved">this</span>.hTRSItems[_sItemId].updateWindowStatus();
	}

	<span class="comment">/** <span class="attrib">@private</span> */</span>
	<span class="reserved">this</span>.onMouseOut		= <span class="reserved">function</span>(_sItemId){
		<span class="reserved">this</span>.hTRSItems[_sItemId].updateWindowStatus(true);
	}

	<span class="comment">/** <span class="attrib">@private</span> */</span>
	<span class="reserved">this</span>.select = <span class="reserved">function</span> (_sItemId) { <span class="reserved">return</span> <span class="reserved">this</span>.hTRSItems[_sItemId].select(); };

	<span class="reserved">this</span>.addItem			= TRSTree_addItem;
	<span class="reserved">this</span>.addRootItem		= TRSTree_addRootItem;
	<span class="reserved">this</span>.toString			= TRSTree_toString;
	<span class="reserved">this</span>.draw				= TRSTree_draw;
	<span class="reserved">this</span>.toHTML				= TRSTree_toHTML;
	<span class="reserved">this</span>.open				= TRSTree_open;
	<span class="reserved">this</span>.openRoot			= CTRSTree_openRoot;
	<span class="reserved">this</span>.onClickCheckBox	= TRSTree_onClickCheckBox;
	<span class="reserved">this</span>.addCheckValue		= TRSTree_addCheckValue;
	<span class="reserved">this</span>.removeCheckValue	= TRSTree_removeCheckValue;
	<span class="reserved">this</span>.getCheckValue		= <span class="reserved">function</span>(){<span class="reserved">return</span> CTRSTree_sCheckValue.replace(new RegExp(CHECK_VALUE_DELIM, <span class="literal">"g"</span>), <span class="literal">","</span>);}
	<span class="reserved">this</span>.onClickRadio		= TRSTree_onClickRadio;
	<span class="reserved">this</span>.getRadioValue		= <span class="reserved">function</span>(){<span class="reserved">return</span> CTRSTree_sRadioValue;}	
	<span class="reserved">this</span>.locate				= TRSTree_locate;
	<span class="reserved">this</span>.reload				= TRSTree_reload;
<span class="comment">	
//Init This CTRSTree Info	</span>
}

<span class="comment">/**
 * 给指定的父节点添加一个子节点
 * <span class="attrib">@param</span> {String} _sName 节点显示名称
 * <span class="attrib">@param</span> {String} _sId	节点ID（必须唯一）
 * <span class="attrib">@param</span> {String} _sToolTip 节点提示信息
 * <span class="attrib">@param</span> {String} _sHref 节点点击后的操作（可以是一个链接也可以是一个JavaScript）,
 *			例如：document_list.jsp或者onClickChannel(13)
 * <span class="attrib">@param</span> {String} _sParentId 指定的父节点
 * <span class="attrib">@param</span> {boolean} _bHasChildren 当前指定节点是否包含子节点（可以不指定，由程序自动维护）
 *			如果强行指定具有子节点，但是没有给当前节点追加子节点，那么系统会自动从服务器载入
 */</span>
<span class="reserved">function</span> TRSTree_addItem(_sName, _sId, _sToolTip, _sHref, _sParentId, _bHasChildren, _nMenuIndex, _sRightValue){
<span class="comment">	//1.Valid Paramerters</span>
	var oNewItem = <span class="reserved">this</span>.hTRSItems[_sId];
	<span class="reserved">if</span>(oNewItem != null){
<span class="comment">		//TODO</span>
<span class="comment">		//CTRSAction_alert("The Node Item Has Exist!\n" + oNewItem);</span>
<span class="comment">		//return oNewItem;</span>
	}
	var oParentItem = null;
	<span class="reserved">if</span>(_sParentId != null &amp;&amp; _sParentId.length&gt;0){
		oParentItem = <span class="reserved">this</span>.hTRSItems[_sParentId];
		<span class="reserved">if</span>(oParentItem == null){
			CTRSAction_alert(<span class="literal">"The Parent Item Has Not Existed!\nParent Id:["</span> + _sParentId + <span class="literal">"]"</span>);
			<span class="reserved">return</span> null;
		}
	}
<span class="comment">
	//2.Add</span>
	oNewItem = new TRSTreeItem(_sName, _sId, _sToolTip, _sHref, oParentItem, _bHasChildren, false, <span class="reserved">this</span>, _nMenuIndex, _sRightValue);
<span class="comment">	//3.Init Checked </span>
	<span class="reserved">if</span>((<span class="reserved">this</span>.nType == TRSTREE_TYPE_CHECKBOX || <span class="reserved">this</span>.nType == TRSTREE_TYPE_RADIOBOX) 
		&amp;&amp; <span class="reserved">this</span>.bInitCheck){
		var sTemp = CHECK_VALUE_DELIM + CTRSTree_sCheckValue + CHECK_VALUE_DELIM;
		oNewItem.checked = (sTemp.indexOf(CHECK_VALUE_DELIM + _sId + CHECK_VALUE_DELIM)&gt;=0);
	}
	<span class="reserved">this</span>.hTRSItems[_sId] = oNewItem;
	<span class="reserved">return</span> oNewItem;
}

<span class="comment">/**
 * 给指定的树添加一个根节点
 * <span class="attrib">@param</span> {String} _sName 节点显示名称
 * <span class="attrib">@param</span> {String} _sId	节点ID（必须唯一）
 * <span class="attrib">@param</span> {String} _sToolTip 节点提示信息
 * <span class="attrib">@param</span> {String} _sHref 节点点击后的操作（可以是一个链接也可以是一个JavaScript）,
 *			例如：document_list.jsp或者onClickChannel(13)
 * <span class="attrib">@param</span> {boolean} _bHasChildren 当前指定节点是否包含子节点（可以不指定，由程序自动维护）
 *			如果强行指定具有子节点，但是没有给当前节点追加子节点，那么系统会自动从服务器载入
 */</span>
<span class="reserved">function</span> TRSTree_addRootItem(_sName, _sId, _sToolTip, _sHref, _bHasChildren, _nMenuIndex, _sRightValue){
<span class="comment">	//1.Valid Paramerters</span>
	var oNewItem = <span class="reserved">this</span>.hTRSItems[_sId];
	<span class="reserved">if</span>(oNewItem != null){
<span class="comment">		//TODO</span>
<span class="comment">		//CTRSAction_alert("The Root Item Has Existed!\n" + oNewItem);</span>
<span class="comment">		//return oNewItem;</span>
	}
<span class="comment">
	//2.Add</span>
	oNewItem = new TRSTreeItem(_sName, _sId, _sToolTip, _sHref, null, _bHasChildren, true, <span class="reserved">this</span>, _nMenuIndex, _sRightValue);
	<span class="reserved">this</span>.arRootTRSItems[<span class="reserved">this</span>.arRootTRSItems.length] = oNewItem;		
	<span class="reserved">this</span>.hTRSItems[_sId] = oNewItem;
	<span class="reserved">return</span> oNewItem;
}

<span class="comment">/**
 * 在当前位置输出当前的树形结构的HTML代码
 */</span>
<span class="reserved">function</span> TRSTree_draw(){
	var oTimer = new CDebugTimer();
	oTimer.start();
	document.write(<span class="reserved">this</span>.toHTML());
	oTimer.stop();
	<span class="reserved">if</span>(TRSTREE_ISDEUG)
		CTRSAction_alert(<span class="literal">"Root write HTML:["</span>+oTimer.getTime()+<span class="literal">"]ms"</span>);

	oTimer.start();
	<span class="reserved">this</span>.openRoot();
	oTimer.stop();
	<span class="reserved">if</span>(TRSTREE_ISDEUG)
		CTRSAction_alert(<span class="literal">"Root open:["</span>+oTimer.getTime()+<span class="literal">"]ms"</span>);

}

<span class="comment">/**
 * 设置初始化选择框的值序列
 * <span class="attrib">@param</span> {String} _sInitCheckValues 初始化的值序列
 */</span>
<span class="reserved">function</span> CTRSTree_setInitCheckValues(_sInitCheckValues){	
	<span class="reserved">this</span>.sInitCheckValues =  _sInitCheckValues;//初始化Check Box的Values,当Type为TRSTREE_TYPE_CHECKBOX有效
	
	<span class="reserved">if</span>(_sInitCheckValues &amp;&amp; _sInitCheckValues.length&gt;0){
		<span class="reserved">if</span>(CTRSTree_sCheckValue == null)
			CTRSTree_sCheckValue	= _sInitCheckValues.replace(new RegExp(<span class="literal">","</span>, <span class="literal">"g"</span>), CHECK_VALUE_DELIM);
		<span class="reserved">if</span>(CTRSTree_sRadioValue == null)
			CTRSTree_sRadioValue	= _sInitCheckValues;
		
		<span class="reserved">this</span>.bInitCheck = true;
		<span class="reserved">this</span>.sInitCheckValues = <span class="literal">","</span> + _sInitCheckValues + <span class="literal">","</span>;
	}
}
<span class="comment">
//定位到指定的节点上，指定的节点为按照路径构造的ID序列</span>
<span class="comment">/**
 * 定位到指定的位置
 * <span class="attrib">@param</span> {String} _sPathIds 定位的路径（按照路径构造的ID序列）
 * <span class="attrib">@param</span> {boolean} _bLocateParent 是否定位到父节点上
 * <span class="attrib">@param</span> {boolean} _bReloadParent 是否再次载入父节点的子节点
 */</span>
<span class="reserved">function</span> TRSTree_locate(_sPathIds, _bLocateParent, _bReloadParent){
	<span class="reserved">if</span>(_sPathIds == null  || _sPathIds.length==0){
		<span class="reserved">return</span>;
	}
	var arPath = _sPathIds.split(<span class="literal">","</span>);
	var nParentCount = arPath.length-1, oParentItem = null;
	<span class="reserved">for</span>(var i=0; i&lt;nParentCount; i++){
		var sItemId = arPath[i];
		var oItem = <span class="reserved">this</span>.hTRSItems[sItemId];
		
		<span class="reserved">if</span>(oItem == null){//载入指定节点的父节点
			<span class="reserved">if</span>(i==0){
				CTRSAction_alert(<span class="literal">"指定的根节点["</span>+sItemId+<span class="literal">"]不存在！"</span>);
				<span class="reserved">return</span>;
			}
			<span class="reserved">for</span>(var nParentIndex=(i-1); nParentIndex&lt;nParentCount; nParentIndex++){
				var sParentId	= arPath[nParentIndex];
				oParentItem = <span class="reserved">this</span>.hTRSItems[sParentId];	
				<span class="reserved">if</span>(oParentItem == null){
					CTRSAction_alert(<span class="literal">"指定的父节点["</span>+i+<span class="literal">"]不存在！"</span>);
					<span class="reserved">return</span>;
				}
				oParentItem.display();
			}
			break;
		}
		
		oItem.display();
		oParentItem = oItem;
	}

	var sLocateItemId = null;
	<span class="reserved">if</span>(_bLocateParent){
		oParentItem.reload();
		oParentItem.select();
		sLocateItemId = oParentItem.sId;
	}<span class="reserved">else</span>{	
		sLocateItemId = arPath[nParentCount];
		var oLocateItem = <span class="reserved">this</span>.hTRSItems[sLocateItemId];
		<span class="reserved">if</span>(oLocateItem == null || _bReloadParent)
			oParentItem.reload();

		oLocateItem = <span class="reserved">this</span>.hTRSItems[sLocateItemId];
		<span class="reserved">if</span>(oLocateItem == null){//子对象不存在定位到父对象上
			oLocateItem = oParentItem;
		}
		oLocateItem.select();
	}
	
	var sHref = window.location.href;
	var nPose = sHref.indexOf(<span class="literal">"#"</span>);
	<span class="reserved">if</span>(nPose&gt;0){
		sHref = sHref.substring(0, nPose);
	}
	window.location.href = sHref + <span class="literal">"#"</span> + <span class="reserved">this</span>.sId + <span class="literal">"_"</span> + sLocateItemId;
}
<span class="comment">



//Record Radio Value</span>
<span class="comment">/** <span class="attrib">@private</span> **/</span>
var CTRSTree_sRadioValue = <span class="literal">""</span>;
<span class="comment">/** <span class="attrib">@private</span> **/</span>
var CTRSTree_sCheckValue = null;

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> CDebugTimer(){
	<span class="reserved">this</span>.lStartTime = 0;
	<span class="reserved">this</span>.lStopTime	= 0;

	<span class="reserved">this</span>.start = <span class="reserved">function</span>(){
		<span class="reserved">this</span>.lStartTime = (new Date()).getTime();
		
	}

	<span class="reserved">this</span>.stop = <span class="reserved">function</span>(){
		<span class="reserved">this</span>.lStopTime = (new Date()).getTime();
		
	}

	<span class="reserved">this</span>.getTime = <span class="reserved">function</span>(){
		<span class="reserved">return</span> parseInt(<span class="reserved">this</span>.lStopTime - <span class="reserved">this</span>.lStartTime);
	}
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> CTRSTree_openRoot(){
	<span class="reserved">for</span>(var i=0; i&lt;<span class="reserved">this</span>.arRootTRSItems.length; i++){		
		<span class="reserved">this</span>.arRootTRSItems[i].open();
	}
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTree_open(_sItemId){
	var oTRSItem = <span class="reserved">this</span>.hTRSItems[_sItemId];
	oTRSItem.open();
}


<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTree_toHTML(){
<span class="comment">	//1.预先载入图片</span>
	var o_icone = new Image(), o_iconl = new Image();
	o_icone.src = <span class="reserved">this</span>.oTRSTreeRes[<span class="literal">'icon_e'</span>];
	o_iconl.src = <span class="reserved">this</span>.oTRSTreeRes[<span class="literal">'icon_l'</span>];
	<span class="reserved">this</span>.oTRSTreeRes[<span class="literal">'im_e'</span>] = o_icone;
	<span class="reserved">this</span>.oTRSTreeRes[<span class="literal">'im_l'</span>] = o_iconl;
	<span class="reserved">for</span> (var i = 0; i &lt; 64; i++){
		<span class="reserved">if</span> (<span class="reserved">this</span>.oTRSTreeRes[<span class="literal">'icon_'</span> + i]) {
			var o_icon = new Image();
			<span class="reserved">this</span>.oTRSTreeRes[<span class="literal">'im_'</span> + i] = o_icon;
			o_icon.src = <span class="reserved">this</span>.oTRSTreeRes[<span class="literal">'icon_'</span> + i];
		}
	}
<span class="comment">
	
	//2.Generate Tree HTML</span>
	var oTimer = new CDebugTimer();
	var sHTML = <span class="literal">""</span>;;
	<span class="reserved">for</span>(var i=0; i&lt;<span class="reserved">this</span>.arRootTRSItems.length; i++){		
		oTimer.start();
		sHTML += <span class="reserved">this</span>.arRootTRSItems[i].toHTML();
		oTimer.stop();
		<span class="reserved">if</span>(TRSTREE_ISDEUG)
			CTRSAction_alert(<span class="literal">"Root toHTML:["</span>+oTimer.getTime()+<span class="literal">"]ms"</span>);
	}

	<span class="reserved">return</span> sHTML;
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTree_beDisabledItem(_sId){//CTRSAction_alert(<span class="reserved">this</span>.oTRSTree + <span class="literal">"--&gt;"</span> +<span class="reserved">this</span>.oTRSTree.arDisabledId);
	var nLength = <span class="reserved">this</span>.oTRSTree.arDisabledId.length || 0;
<span class="comment">	//var nLength = 0;</span>
	<span class="reserved">if</span>(nLength &lt;= 0) <span class="reserved">return</span> false;
	<span class="reserved">for</span>(var i=0; i&lt;nLength; i++){
		<span class="reserved">if</span>(_sId == <span class="reserved">this</span>.oTRSTree.arDisabledId[i]) <span class="reserved">return</span> true;
	}
	<span class="reserved">return</span> false;
}


<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTree_toString(){
	var sInfo = <span class="literal">"The CTRSTree Information:\n"</span>
				+<span class="literal">"Root Element Size:["</span>+(<span class="reserved">this</span>.arRootTRSItems.length)+<span class="literal">"]\n"</span>;					
	<span class="reserved">return</span> sInfo;
}


<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_init(){
	<span class="reserved">if</span>(<span class="reserved">this</span>.oParentItem != null){
		<span class="reserved">this</span>.oRootItem	= <span class="reserved">this</span>.oParentItem.oRootItem;
		<span class="reserved">this</span>.oParentItem.addChild(<span class="reserved">this</span>);
		<span class="reserved">this</span>.nDepth		= <span class="reserved">this</span>.oParentItem.nDepth+1;
		<span class="reserved">this</span>.nIndex		= <span class="reserved">this</span>.oParentItem.arChildren.length-1;
	}
	<span class="reserved">if</span>(<span class="reserved">this</span>.bRoot){
		<span class="reserved">this</span>.nDepth		= 0;
		<span class="reserved">this</span>.oRootItem	= <span class="reserved">this</span>;
		<span class="reserved">this</span>.nIndex		= <span class="reserved">this</span>.oTRSTree.arRootTRSItems.length-1;
		<span class="reserved">this</span>.oParentItem=<span class="reserved">this</span>;
	}
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_select(b_deselect){
	<span class="reserved">if</span> (!b_deselect) {
		var oOldSelectedItem = <span class="reserved">this</span>.oTRSTree.oSelectedItem;
		<span class="reserved">this</span>.oTRSTree.oSelectedItem = <span class="reserved">this</span>;
		<span class="reserved">if</span> (oOldSelectedItem) oOldSelectedItem.select(true);
	}

	var o_iicon = document.images[<span class="literal">'i_img'</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">'_'</span> + <span class="reserved">this</span>.sId];
	<span class="reserved">if</span> (o_iicon){
		var sNewImageSrc = <span class="reserved">this</span>.getIcon();
		<span class="reserved">if</span>(sNewImageSrc != o_iicon.src){
<span class="comment">			//CTRSAction_alert(sNewImageSrc);</span>
<span class="comment">			//CTRSAction_alert(o_iicon.src);</span>
<span class="comment">			//o_iicon.src = sNewImageSrc;</span>
		}
	}
<span class="comment">	
	//get_element('i_txt' + this.oTRSTree.sId + '_' + this.sId).style.fontWeight = b_deselect ? 'normal' : 'bold';</span>
	var sElementId = <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">'_'</span> + <span class="reserved">this</span>.sId;
	var oElement = get_element(sElementId);
	<span class="reserved">if</span>(oElement != null)
		oElement.className = b_deselect ? <span class="literal">'tree_normal'</span> : <span class="literal">'tree_selected'</span>;

	<span class="reserved">this</span>.updateWindowStatus();
<span class="comment">	
	//return Boolean(this.sHref);</span>
	<span class="reserved">return</span> true;
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_getPublicEventHTML(){
	<span class="reserved">return</span> <span class="literal">"onmouseover='m_arTRSTrees["</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">"].onMouseOver(\"</span><span class="literal">" + this.sId + "</span>\<span class="literal">");' "</span>
		+<span class="literal">"onmouseout='m_arTRSTrees["</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">"].onMouseOut(\"</span><span class="literal">" + this.sId + "</span>\<span class="literal">");'"</span>;
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_getNodeFlagImgName(){
	<span class="reserved">return</span> <span class="literal">"j_img"</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">"_"</span> + <span class="reserved">this</span>.sId ;
}
<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_getNodeImgHTML(){
	<span class="reserved">if</span>(<span class="reserved">this</span>.nDepth&lt;=0){
<span class="comment">		//return "";</span>
	}

	var arOffset = [], oTRSItemTemp = <span class="reserved">this</span>.oParentItem;
	<span class="reserved">for</span> (var i = <span class="reserved">this</span>.nDepth; i &gt; 0; i--) {
		arOffset[i] = <span class="literal">'&lt;img src="'</span> + <span class="reserved">this</span>.oTRSTree.oTRSTreeRes[oTRSItemTemp.isLast() ? <span class="literal">'icon_e'</span> : <span class="literal">'icon_l'</span>] + <span class="literal">'" '</span>
					+<span class="literal">'border="0" align="absbottom"&gt;'</span>;
		oTRSItemTemp = oTRSItemTemp.oParentItem;
	}

	<span class="reserved">if</span>(!<span class="reserved">this</span>.bHasChildren){//元素节点
		<span class="reserved">return</span> arOffset.join(<span class="literal">''</span>)
			+ <span class="literal">"&lt;img src=\"</span><span class="literal">" + this.getIcon(true) + "</span>\<span class="literal">" border=0 align=absbottom&gt;"</span>;
	}

	<span class="reserved">return</span> arOffset.join(<span class="literal">""</span>) 
		+ <span class="literal">"&lt;a href='###' onclick='m_arTRSTrees["</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">"].open(\"</span><span class="literal">" + this.sId + "</span>\<span class="literal">");return false;' "</span>
		+ <span class="reserved">this</span>.getPublicEventHTML()
		+<span class="literal">" &gt;"</span>
		+<span class="literal">"&lt;img src=\"</span><span class="literal">" + this.getIcon(true) + "</span>\<span class="literal">" border=0 align=absbottom name=\"</span><span class="literal">"+this.getNodeFlagImgName()+"</span>\<span class="literal">"&gt;&lt;/a&gt;"</span>;		
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_getItemDivId(){
	<span class="reserved">return</span> <span class="literal">'i_div'</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">'_'</span> + <span class="reserved">this</span>.sId;
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_getItemDiv(){
	var oItemDiv = get_element(<span class="reserved">this</span>.getItemDivId());
	<span class="reserved">if</span> (!oItemDiv){
		CTRSAction_alert(<span class="literal">"Error Exception:Not Found ["</span>+<span class="reserved">this</span>.getItemDivId()+<span class="literal">"]Div"</span>)
		<span class="reserved">return</span> null;
	}
	<span class="reserved">return</span> oItemDiv;
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_getItemSpanId(){
	<span class="reserved">return</span> <span class="literal">'i_Span'</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">'_'</span> + <span class="reserved">this</span>.sId;
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_getItemSpan(){
	var oItemSpan = get_element(<span class="reserved">this</span>.getItemSpanId());
	<span class="reserved">if</span> (!oItemSpan){
		CTRSAction_alert(<span class="literal">"Error Exception:Not Found ["</span>+<span class="reserved">this</span>.getItemSpanId()+<span class="literal">"]Span"</span>)
		<span class="reserved">return</span> null;
	}
	<span class="reserved">return</span> oItemSpan;
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_getIcon (_bJunction) {
<span class="comment">	//处理自定义节点图片的情况</span>
	<span class="reserved">if</span>(!_bJunction){		
		var sSrc = <span class="reserved">this</span>.oTRSTree.oTRSTreeRes[<span class="literal">"icon_n_"</span>+<span class="reserved">this</span>.sId];
		<span class="reserved">if</span>(sSrc != null)<span class="reserved">return</span> sSrc;
	}
<span class="comment">
	//根据规则返回图片</span>
	var sIconId = <span class="literal">'im_'</span> + ((<span class="reserved">this</span>.nDepth ? 0 : 32) + (<span class="reserved">this</span>.bHasChildren ? 16 : 0) 
			+ (<span class="reserved">this</span>.bHasChildren &amp;&amp; <span class="reserved">this</span>.bOpened ? 8 : 0) 
			+ (!_bJunction &amp;&amp; <span class="reserved">this</span>.oTRSTree.oSelectedItem == <span class="reserved">this</span> ? 4 : 0) + (_bJunction ? 2 : 0) 
			+ (_bJunction &amp;&amp; <span class="reserved">this</span>.isLast() ? 1 : 0));
<span class="comment">	//CTRSAction_alert(this.oTRSTree.oTRSTreeRes[sIconId].src);</span>
	<span class="reserved">return</span> <span class="reserved">this</span>.oTRSTree.oTRSTreeRes[sIconId].src;
}

<span class="comment">/** <span class="attrib">@private</span> **/</span>
<span class="reserved">function</span> TRSTreeItem_updateWindowStatus(_bClear){
	window.setTimeout(<span class="literal">'window.status="'</span> + (_bClear ? <span class="literal">''</span> : <span class="reserved">this</span>.sToolTip)+ <span class="literal">'  ItemID:['</span>+<span class="reserved">this</span>.sId+<span class="literal">']"'</span>, 10);
}

<span class="comment">/**
 * 根据指定的父节点ID动态载入子节点的列表（抽象方法）
 *（动态载入子节点的树形结构需要实现此方法）
 * <span class="attrib">@param</span> {TRSTree} 树形结构对象（CTRSTree的实例）
 * <span class="attrib">@param</span> {String} 当前父节点的ID
 * <span class="attrib">@param</span> {TRSTreeItem} 当前父节点对象
 */</span>
<span class="reserved">function</span> TRSTreeItem_loadChildren(_oTRSTree, _sParentId, _oCurrItem){
<span class="comment">	//_oTRSTree.addItem("第一个子节点名称", "第一个子节点ID", "第一个子节点提示", "第一个子节点链接", _sParentId, false);</span>
<span class="comment">	//_oTRSTree.addItem("第二个子节点名称", "第二个子节点ID", "第二个子节点名称", "第二个子节点链接", _sParentId, false);</span>
	CTRSAction_alert(<span class="literal">"function TRSTreeItem_loadChildren(_oTRSTree, _sParentId, _oCurrItem){...} Not Implemented!"</span>);	
}

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTreeItem_open() {
	<span class="reserved">if</span>(!<span class="reserved">this</span>.bHasChildren)
		<span class="reserved">return</span>;
<span class="comment">	//Get Item Div</span>
	var oItemDiv = <span class="reserved">this</span>.getItemDiv();
	<span class="reserved">if</span> (oItemDiv == null){
		<span class="reserved">return</span>;
	}
<span class="comment">	
	//Set Item Div HTML and Display</span>
	<span class="reserved">if</span>(<span class="reserved">this</span>.bHasChildren &amp;&amp; (<span class="reserved">this</span>.arChildren==null || <span class="reserved">this</span>.arChildren.length==0))
	{//Need Loading....
		var arOffset = [], oTRSItemTemp = <span class="reserved">this</span>;
		<span class="reserved">for</span> (var i = <span class="reserved">this</span>.nDepth; i &gt; 0; i--) {
			arOffset[i] = <span class="literal">'&lt;img src="'</span> + <span class="reserved">this</span>.oTRSTree.oTRSTreeRes[oTRSItemTemp.isLast() ? <span class="literal">'icon_e'</span> : <span class="literal">'icon_l'</span>] + <span class="literal">'" '</span>
						+<span class="literal">'border="0" align="absbottom"&gt;'</span>;
			oTRSItemTemp = oTRSItemTemp.oParentItem;
		}

		oItemDiv.innerHTML = arOffset.join(<span class="literal">''</span>) + <span class="literal">"&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span>
							+<span class="literal">"&lt;a class=\"</span>t<span class="literal">" + this.oTRSTree.sId + "</span>i\<span class="literal">" onclick=\"</span><span class="reserved">return</span> false;\<span class="literal">"&gt;&lt;font color=blue&gt;Loading...&lt;/font&gt;&lt;/a&gt;"</span>;
		oItemDiv.style.display = (<span class="reserved">this</span>.bOpened ? <span class="literal">'none'</span> : <span class="literal">'block'</span>);
		<span class="reserved">this</span>.bLoading = true;
		TRSTreeItem_loadChildren(<span class="reserved">this</span>.oTRSTree, <span class="reserved">this</span>.sId, <span class="reserved">this</span>);	
<span class="comment">		
		//Not Load Children</span>
		<span class="reserved">if</span>((<span class="reserved">this</span>.arChildren==null || <span class="reserved">this</span>.arChildren.length==0)){
			
			<span class="reserved">this</span>.bHasChildren = false;
			<span class="reserved">this</span>.arChildren = null;
			var oItemSpan = <span class="reserved">this</span>.getItemSpan();
			<span class="reserved">if</span>(oItemSpan == null){
				<span class="reserved">return</span>;
			}
			oItemSpan.innerHTML = <span class="reserved">this</span>.toHTML();
			<span class="reserved">return</span>;
		}
	}
	
	<span class="reserved">if</span> (!oItemDiv.innerHTML || (<span class="reserved">this</span>.bLoading &amp;&amp; <span class="reserved">this</span>.arChildren)) {
		<span class="reserved">this</span>.bLoading = false;
		var arChildrenHTML = [];
		<span class="reserved">for</span> (var i = 0; i &lt; <span class="reserved">this</span>.arChildren.length; i++)
			arChildrenHTML[i]= <span class="reserved">this</span>.arChildren[i].toHTML();
		oItemDiv.innerHTML = arChildrenHTML.join(<span class="literal">''</span>);
	}
	oItemDiv.style.display = (<span class="reserved">this</span>.bOpened ? <span class="literal">'none'</span> : <span class="literal">'block'</span>);
<span class="comment">	
	//Upate Item Statuses</span>
	<span class="reserved">this</span>.bOpened = !<span class="reserved">this</span>.bOpened;
	var o_jicon = document.images[<span class="reserved">this</span>.getNodeFlagImgName()],
		o_iicon = document.images[<span class="literal">'i_img'</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">'_'</span> + <span class="reserved">this</span>.sId];
	<span class="reserved">if</span> (o_jicon) o_jicon.src = <span class="reserved">this</span>.getIcon(true);
	<span class="reserved">if</span> (o_iicon) o_iicon.src = <span class="reserved">this</span>.getIcon();
<span class="comment">	
	//Upate Window Statuses</span>
	<span class="reserved">this</span>.updateWindowStatus();
}

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTreeItem_display(){
	<span class="reserved">if</span>(<span class="reserved">this</span>.bOpened)
		<span class="reserved">return</span>;
	<span class="reserved">this</span>.open();
}

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTreeItem_reload(){
	<span class="reserved">this</span>.bHasChildren = true;

	<span class="reserved">if</span>(<span class="reserved">this</span>.arChildren != null){
		<span class="reserved">this</span>.arChildren.splice(0, <span class="reserved">this</span>.arChildren.length);
		<span class="reserved">this</span>.arChildren = null;
		<span class="reserved">this</span>.bOpened = false;
	}

	<span class="reserved">this</span>.open();
}




<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTreeItem_addChild(_TRSTreeItem){
	<span class="reserved">if</span>(<span class="reserved">this</span>.arChildren == null)
		<span class="reserved">this</span>.arChildren = new Array();

	<span class="reserved">this</span>.arChildren[<span class="reserved">this</span>.arChildren.length] = _TRSTreeItem;
	<span class="reserved">this</span>.bHasChildren	= true;
}

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTreeItem_toString(){
	var sInfo = <span class="literal">"Name:["</span>+<span class="reserved">this</span>.sName+<span class="literal">"] Id:["</span>+<span class="reserved">this</span>.sId+<span class="literal">"]  Href:["</span>+<span class="reserved">this</span>.sHref+<span class="literal">"] \n"</span>
				+<span class="literal">"ParentId:["</span>+(<span class="reserved">this</span>.oParentItem?<span class="reserved">this</span>.oParentItem.sId:<span class="literal">""</span>)+<span class="literal">"] "</span>
				+<span class="literal">"Children:["</span>+(<span class="reserved">this</span>.arChildren?<span class="reserved">this</span>.arChildren.length:0)+<span class="literal">"]\n"</span>
				+(<span class="reserved">this</span>.bRoot?<span class="literal">""</span>:<span class="literal">"Not "</span>)+<span class="literal">"Is Root Node!\n"</span>;
	<span class="reserved">return</span> sInfo;
}

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTreeItem_isLast(){
	<span class="reserved">if</span>(<span class="reserved">this</span>.oParentItem == <span class="reserved">this</span>)<span class="reserved">return</span> false;

	<span class="reserved">return</span> <span class="reserved">this</span>.nIndex == <span class="reserved">this</span>.oParentItem.arChildren.length - 1
}

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTreeItem_toHTML(){
	var sHTML = <span class="literal">'&lt;span id="'</span>+<span class="reserved">this</span>.getItemSpanId()+<span class="literal">'" title="'</span>+<span class="reserved">this</span>.sToolTip+<span class="literal">'"&gt;&lt;table cellpadding="0" cellspacing="0" border="0"&gt;&lt;tr '</span>;
	<span class="reserved">if</span>(<span class="reserved">this</span>.nMenuIndex != null)
		sHTML += <span class="literal">' MenuIndex="'</span> + <span class="reserved">this</span>.nMenuIndex + <span class="literal">'" '</span>;
	<span class="reserved">if</span>(<span class="reserved">this</span>.sRightValue != null &amp;&amp; <span class="reserved">this</span>.sRightValue.length &gt; 0)
		sHTML += <span class="literal">' RightValue="'</span> + <span class="reserved">this</span>.sRightValue + <span class="literal">'" '</span>;
	<span class="reserved">if</span>(<span class="reserved">this</span>.bRoot)
		sHTML += <span class="literal">' SiteId='</span> + <span class="reserved">this</span>.sId.substring(1) + <span class="literal">' '</span>;
	<span class="reserved">else</span>
		sHTML += <span class="literal">' ChannelId='</span> + <span class="reserved">this</span>.sId + <span class="literal">' '</span>;
	<span class="reserved">if</span>(<span class="reserved">this</span>.oParentItem){
<span class="comment">		//var sParentId = this.oParentItem.sId;</span>
<span class="comment">		//WSW @ 2005-6-16 修改bug，需要把可能的整形值转成字符串类型，否则可能在下一步的substring出错。</span>
		var sParentId = <span class="reserved">this</span>.oParentItem.sId + <span class="literal">""</span>;
		<span class="reserved">if</span>(sParentId.substring(0, 1) == <span class="literal">"S"</span>)
			sHTML += <span class="literal">' ParentType=103 '</span>+<span class="literal">'ParentId='</span>+sParentId.substring(1);
		<span class="reserved">else</span>
			sHTML += <span class="literal">' ParentType=101 '</span>+<span class="literal">'ParentId='</span>+sParentId;
	}<span class="reserved">else</span>{
		CTRSAction_alert(<span class="literal">'why parent is null??'</span>);
	}

	sHTML += <span class="literal">' &gt;&lt;td nowrap&gt;'</span>
		+ <span class="reserved">this</span>.getNodeImgHTML()
		+<span class="literal">'&lt;img src="'</span> + <span class="reserved">this</span>.getIcon() + <span class="literal">'" border="0" align="absbottom" name="i_img'</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">'_'</span> + <span class="reserved">this</span>.sId + <span class="literal">'"'</span>
		+<span class="literal">' class="t'</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">'im"&gt;'</span>
		+ <span class="reserved">this</span>.getTypeHTML()
		+ ((<span class="reserved">this</span>.sHref==null || <span class="reserved">this</span>.sHref==<span class="literal">""</span>)?<span class="literal">"&lt;a onclick=\"</span><span class="reserved">return</span> false;\<span class="literal">"&gt;"</span>:
			<span class="literal">"&lt;a name=\"</span><span class="literal">"+this.oTRSTree.sId+"</span>_<span class="literal">"+this.sId+"</span>\<span class="literal">" ID=\"</span><span class="literal">"+this.sId+"</span>\<span class="literal">" href='"</span> + <span class="reserved">this</span>.sHref + <span class="literal">"' target='"</span> + <span class="reserved">this</span>.oTRSTree.sTarget+ <span class="literal">"' "</span>
		+<span class="literal">" onclick='return m_arTRSTrees["</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">"].select(\"</span><span class="literal">" + this.sId + "</span>\<span class="literal">");'"</span>
		+<span class="literal">" onmousedown='return m_arTRSTrees["</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">"].select(\"</span><span class="literal">" + this.sId + "</span>\<span class="literal">");'"</span>
		+<span class="literal">" ondblclick='m_arTRSTrees["</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">"].open(\"</span><span class="literal">" + this.sId + "</span>\<span class="literal">");' "</span>
		+ <span class="reserved">this</span>.getPublicEventHTML()		
		+<span class="literal">' class="t'</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">'i" id="'</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">'_'</span> + <span class="reserved">this</span>.sId + <span class="literal">'"&gt;'</span>)
		+ <span class="reserved">this</span>.sName + <span class="literal">'&lt;/a&gt;'</span>
		+<span class="literal">'&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span>
		+ <span class="literal">'&lt;div id="'</span> + <span class="reserved">this</span>.getItemDivId() + <span class="literal">'" style="display:none"&gt;&lt;/div&gt;'</span>//TODO Children的优化
		+<span class="literal">"&lt;/span&gt;"</span>;		
<span class="comment">//		+ (this.bHasChildren ? '&lt;div id="' + this.getItemDivId() + '" style="display:none"&gt;&lt;/div&gt;' : '')</span>
<span class="comment">//		+"&lt;/span&gt;";</span>
	<span class="reserved">return</span> sHTML;
}

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTreeItem_getTypeHTML(){
	<span class="reserved">if</span>(<span class="reserved">this</span>.oTRSTree.nType == TRSTREE_TYPE_NORMAL || <span class="reserved">this</span>.nDepth &lt;= 0)
		<span class="reserved">return</span> <span class="literal">""</span>;

	<span class="reserved">if</span>(<span class="reserved">this</span>.oTRSTree.nType == TRSTREE_TYPE_CHECKBOX){
		<span class="reserved">if</span>(<span class="reserved">this</span>.checked){
			<span class="reserved">this</span>.oTRSTree.addCheckValue(<span class="reserved">this</span>.sId);
		}
		var sHtml = <span class="literal">"&lt;input type=checkbox name=\"</span>TRSTreeNode\<span class="literal">" value=\"</span><span class="literal">"+this.sId+"</span>\<span class="literal">" "</span>
				+(<span class="reserved">this</span>.checked?<span class="literal">"checked"</span>:<span class="literal">""</span>)
				+<span class="literal">" onclick='m_arTRSTrees["</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">"].onClickCheckBox(this);'"</span>;
				
		<span class="reserved">if</span>(<span class="reserved">this</span>.beDisabledItem(<span class="reserved">this</span>.sId))
			sHtml += <span class="literal">" disabled "</span>;
		sHtml += <span class="literal">"&gt;"</span>;
		<span class="reserved">return</span> sHtml;
	}

	<span class="reserved">if</span>(<span class="reserved">this</span>.oTRSTree.nType == TRSTREE_TYPE_RADIOBOX){
		<span class="reserved">if</span>(<span class="reserved">this</span>.checked){
			CTRSTree_sRadioValue = <span class="reserved">this</span>.sId;
		}
		var sHtml = <span class="literal">"&lt;input type=radio name=\"</span>TRSTreeNode\<span class="literal">" value=\"</span><span class="literal">"+this.sId+"</span>\<span class="literal">" "</span> 
				+(<span class="reserved">this</span>.checked?<span class="literal">"checked"</span>:<span class="literal">""</span>)
				+<span class="literal">" onclick='m_arTRSTrees["</span> + <span class="reserved">this</span>.oTRSTree.sId + <span class="literal">"].onClickRadio(this);'"</span>;
		<span class="reserved">if</span>(<span class="reserved">this</span>.beDisabledItem(<span class="reserved">this</span>.sId))
			sHtml += <span class="literal">" disabled "</span>;
		sHtml += <span class="literal">"&gt;"</span>;
		<span class="reserved">return</span> sHtml;
	}
}

var CHECK_VALUE_DELIM = <span class="literal">"~~"</span>;
<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTree_addCheckValue(_sValue){
	var sCheckValue = CTRSTree_sCheckValue;	
	<span class="reserved">if</span>(sCheckValue == null || sCheckValue.length == 0 || sCheckValue==<span class="literal">"NULL"</span> || sCheckValue==<span class="literal">"null"</span>){
		CTRSTree_sCheckValue = _sValue;
		<span class="reserved">return</span> true;
	}
	
	sCheckValue = CHECK_VALUE_DELIM + sCheckValue + CHECK_VALUE_DELIM;
	var nPose = sCheckValue.indexOf(CHECK_VALUE_DELIM + _sValue + CHECK_VALUE_DELIM);
	<span class="reserved">if</span>(nPose&gt;=0)
		<span class="reserved">return</span> true;

	CTRSTree_sCheckValue += CHECK_VALUE_DELIM + _sValue;
}

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTree_removeCheckValue(_sValue){
	var sCheckValue = CTRSTree_sCheckValue;	
	<span class="reserved">if</span>(sCheckValue == null || sCheckValue.length == 0){
		<span class="reserved">return</span> true;
	}
	
	sCheckValue = CHECK_VALUE_DELIM + sCheckValue + CHECK_VALUE_DELIM;
	var nPose = sCheckValue.indexOf(CHECK_VALUE_DELIM + _sValue + CHECK_VALUE_DELIM);
	<span class="reserved">if</span>(nPose==0){
		CTRSTree_sCheckValue = CTRSTree_sCheckValue.substring((_sValue + CHECK_VALUE_DELIM).length);
	}<span class="reserved">else</span> <span class="reserved">if</span>(nPose&gt;0){
		CTRSTree_sCheckValue = CTRSTree_sCheckValue.substring(0, nPose-CHECK_VALUE_DELIM.length) 
			+ CTRSTree_sCheckValue.substring(nPose + _sValue.length);
	}		
}


<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTree_onClickCheckBox(_elCheckBox){
	<span class="reserved">if</span>(_elCheckBox == null)
		<span class="reserved">return</span> true;
	
	<span class="reserved">this</span>.hTRSItems[_elCheckBox.value].checked = _elCheckBox.checked;
	<span class="reserved">if</span>(_elCheckBox.checked){
		<span class="reserved">this</span>.addCheckValue(_elCheckBox.value);
	}<span class="reserved">else</span>{
		<span class="reserved">this</span>.removeCheckValue(_elCheckBox.value);
	}	
	<span class="reserved">return</span> true;
}

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTree_onClickRadio(_elRadio){
	<span class="reserved">this</span>.hTRSItems[_elRadio.value].checked = _elRadio.checked;
	<span class="reserved">if</span>(_elRadio.checked){		
		CTRSTree_sRadioValue = _elRadio.value;		
	}<span class="reserved">else</span>{
		<span class="reserved">if</span>(CTRSTree_sRadioValue == _elRadio.value){
			CTRSTree_sRadioValue = <span class="literal">""</span>;			
		}
	}
	<span class="reserved">return</span> true;
}

get_element = document.all ?
	<span class="reserved">function</span> (s_id) { <span class="reserved">return</span> document.all(s_id) } :
	<span class="reserved">function</span> (s_id) { <span class="reserved">return</span> document.getElementById(s_id) };

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
<span class="reserved">function</span> TRSTreeItem(_sName, _sId, _sToolTip, _sHref, _oParentItem, _bHasChildren, _bRoot, _oTRSTree, _nMenuIndex, _sRightValue){
<span class="comment">//Define Properties</span>
	<span class="reserved">this</span>.sName			= _sName		|| <span class="literal">""</span>;
	<span class="reserved">this</span>.sId			= _sId			|| <span class="literal">""</span>;
	<span class="reserved">this</span>.sToolTip		= _sToolTip		|| <span class="reserved">this</span>.sName;
	<span class="reserved">this</span>.sHref			= _sHref		|| <span class="literal">""</span>;
	<span class="reserved">this</span>.nDepth			= -1;

	<span class="reserved">this</span>.oParentItem	= _oParentItem	|| null;
	<span class="reserved">this</span>.arChildren		= null;
	<span class="reserved">this</span>.oRootItem		= null;
	
	<span class="reserved">this</span>.nMenuIndex		= _nMenuIndex || 0;
	<span class="reserved">this</span>.sRightValue	= _sRightValue || <span class="literal">""</span>;

	<span class="reserved">this</span>.bRoot			= _bRoot		|| false;
	<span class="reserved">this</span>.bHasChildren	= _bHasChildren || false;

	<span class="reserved">this</span>.oTRSTree		= _oTRSTree;
	<span class="reserved">this</span>.bOpened		= false;

	<span class="reserved">this</span>.checked			= false;
<span class="comment">
//Define Methods</span>
	<span class="reserved">this</span>.addChild			= TRSTreeItem_addChild;
	<span class="reserved">this</span>.open				= TRSTreeItem_open;
	<span class="reserved">this</span>.display			= TRSTreeItem_display;
	<span class="reserved">this</span>.select				= TRSTreeItem_select;

	<span class="reserved">this</span>.isLast				= TRSTreeItem_isLast;
	<span class="reserved">this</span>.getItemSpanId		= TRSTreeItem_getItemSpanId;
	<span class="reserved">this</span>.getItemSpan		= TRSTreeItem_getItemSpan;
	<span class="reserved">this</span>.getItemDivId		= TRSTreeItem_getItemDivId;
	<span class="reserved">this</span>.getItemDiv			= TRSTreeItem_getItemDiv;
	<span class="reserved">this</span>.getIcon			= TRSTreeItem_getIcon;
	<span class="reserved">this</span>.getNodeFlagImgName	= TRSTreeItem_getNodeFlagImgName;
	<span class="reserved">this</span>.getNodeImgHTML		= TRSTreeItem_getNodeImgHTML;
	<span class="reserved">this</span>.getPublicEventHTML = TRSTreeItem_getPublicEventHTML;
	<span class="reserved">this</span>.getTypeHTML		= TRSTreeItem_getTypeHTML;

	<span class="reserved">this</span>.toString			= TRSTreeItem_toString;	
	<span class="reserved">this</span>.toHTML				= TRSTreeItem_toHTML;

	<span class="reserved">this</span>.updateWindowStatus	= TRSTreeItem_updateWindowStatus;
	<span class="reserved">this</span>.init				= TRSTreeItem_init;

	<span class="reserved">this</span>.reload			= TRSTreeItem_reload;

	<span class="reserved">this</span>.beDisabledItem = TRSTree_beDisabledItem;
<span class="comment">//Init This Item and Parent Item Info</span>
	<span class="reserved">this</span>.init();
}



<span class="reserved">function</span> TRSTree_reload(_sItemId){
	var sItemId = _sItemId || <span class="literal">""</span>;
	<span class="reserved">if</span>(sItemId == null || sItemId.length &lt;= 0)
		<span class="reserved">return</span>;

	var oItem = <span class="reserved">this</span>.hTRSItems[sItemId];
	<span class="reserved">if</span>(oItem == null)
		<span class="reserved">return</span>;

	oItem.reload();
}

<span class="comment">/** 
 * 树形结构的调试开关 
 * <span class="attrib">@type</span> boolean
 */</span>
var TRSTREE_ISDEUG			= false;
<span class="comment">/** <span class="attrib">@const</span> {int} 树形结构的类型：普通型（0） */</span>
var TRSTREE_TYPE_NORMAL		= 0;
<span class="comment">/** <span class="attrib">@const</span> {int} 树形结构的类型：多选型（1） */</span>
var TRSTREE_TYPE_CHECKBOX	= 1;
<span class="comment">/** <span class="attrib">@const</span> {int} 树形结构的类型：单选型（2） */</span>
var TRSTREE_TYPE_RADIOBOX	= 2;
<span class="comment">/** 
 * 记录当前页面所有的TRSTree对象
 * <span class="attrib">@type</span> Array
 */</span>
var m_arTRSTrees = [];
</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Sun Jul 31 10:46:14 2005</div>
</body>
</html>
